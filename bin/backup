#!/usr/bin/env bash

hdd_id="9dd86e7a-4995-414c-906f-489ca8cc1c3b"
mnt_path="/mnt/HDD"
dst="$mnt_path"/$(date +%d-%m-%Y)


if [ "$UID" -ne 0 ]; then
	echo Error: Permission denied
	exit 1
fi

if ! lsblk -f | grep HDD | grep -q /mnt/HDD; then
	if ! mount UUID="$hdd_id" "$mnt_path"; then
		exit 1
	fi
fi

if ! mkdir "$dst"; then
	exit 1
fi

rsync -aAXHv --exclude={"/usr/src/","/var/cache/distfiles/","/var/db/repos/"} /boot /etc /home /root /usr /var "$dst"
